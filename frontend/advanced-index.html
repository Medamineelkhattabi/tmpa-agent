<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oracle EBS R12 i-Supplier Assistant - Tanger Med</title>
    <link rel="stylesheet" href="advanced-styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="/static/images/favicon.ico">
    <meta name="description" content="AI-powered Oracle EBS R12 i-Supplier assistant for Tanger Med suppliers">
    <meta name="keywords" content="Oracle EBS, i-Supplier, Tanger Med, AI Assistant, Procurement">
</head>
<body>
    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Main App Container -->
    <div class="app-container">
        <!-- Enhanced Header -->
        <header class="header">
            <div class="header-left">
                <div class="logo">🚢 Oracle EBS Assistant</div>
                <div class="status-indicator">
                    <span id="connectionStatus" class="status-dot online"></span>
                    <span>Connected</span>
                </div>
            </div>
            
            <div class="header-controls">
                <select id="languageSelect" class="control-btn">
                    <option value="en">🇺🇸 English</option>
                    <option value="fr">🇫🇷 Français</option>
                    <option value="ar">🇲🇦 العربية</option>
                </select>
                
                <button id="themeToggle" class="control-btn" title="Toggle Dark Mode">
                    🌙 Theme
                </button>
                
                <button id="exportChat" class="control-btn" title="Export Chat History">
                    📥 Export
                </button>
                
                <button id="clearChat" class="control-btn" title="Clear Chat">
                    🗑️ Clear
                </button>
                
                <div class="user-menu">
                    <button class="control-btn">
                        👤 User
                    </button>
                </div>
            </div>
        </header>

        <!-- Enhanced Sidebar -->
        <aside class="sidebar">
            <!-- Progress Section -->
            <div class="sidebar-section">
                <div class="sidebar-title">Current Progress</div>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                    </div>
                    <div id="progressText" class="progress-text">No active procedure</div>
                </div>
                
                <div id="currentProcedure" class="current-procedure">
                    <div class="procedure-info">
                        <div class="procedure-title">Ready to assist</div>
                        <div class="procedure-description">Start a procedure or ask a question</div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="sidebar-section">
                <div class="sidebar-title">Quick Actions</div>
                <div class="quick-actions">
                    <button class="quick-action-btn" onclick="assistant.quickAction('work confirmation')">
                        📋 Work Confirmation
                    </button>
                    <button class="quick-action-btn" onclick="assistant.quickAction('submit invoice')">
                        🧾 Submit Invoice
                    </button>
                    <button class="quick-action-btn" onclick="assistant.quickAction('view purchase orders')">
                        📦 Purchase Orders
                    </button>
                    <button class="quick-action-btn" onclick="assistant.quickAction('goods receipt')">
                        ✅ Goods Receipt
                    </button>
                    <button class="quick-action-btn" onclick="assistant.quickAction('payment tracking')">
                        💰 Payment Tracking
                    </button>
                    <button class="quick-action-btn" onclick="assistant.quickAction('analytics dashboard')">
                        📊 Analytics
                    </button>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="sidebar-section">
                <div class="sidebar-title">Recent Activity</div>
                <div id="recentActivity" class="recent-activity">
                    <div class="activity-item">
                        <div class="activity-icon">🕐</div>
                        <div class="activity-text">
                            <div class="activity-title">Session Started</div>
                            <div class="activity-time">Just now</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- System Status -->
            <div class="sidebar-section">
                <div class="sidebar-title">System Status</div>
                <div class="system-status">
                    <div class="status-item">
                        <span class="status-label">Oracle EBS</span>
                        <span class="status-value online">Online</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">AI Assistant</span>
                        <span class="status-value online">Active</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Session</span>
                        <span id="sessionDuration" class="status-value">00:00</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Enhanced Chat Container -->
        <main class="chat-container">
            <!-- Chat Messages -->
            <div id="chatMessages" class="chat-messages">
                <!-- Welcome Message -->
                <div class="message assistant-message welcome-message">
                    <div class="message-header">
                        <span class="message-type">🤖 Oracle EBS Assistant</span>
                        <span class="message-time" id="welcomeTime"></span>
                    </div>
                    <div class="message-content">
                        <div class="welcome-content">
                            <h2>🚢 Welcome to Oracle EBS R12 i-Supplier Assistant</h2>
                            <p>Your intelligent guide for Tanger Med supplier operations</p>
                            
                            <div class="feature-highlights">
                                <div class="feature-item">
                                    <span class="feature-icon">🎯</span>
                                    <span>Step-by-step procedure guidance</span>
                                </div>
                                <div class="feature-item">
                                    <span class="feature-icon">📊</span>
                                    <span>Real-time data analytics</span>
                                </div>
                                <div class="feature-item">
                                    <span class="feature-icon">🤖</span>
                                    <span>AI-powered recommendations</span>
                                </div>
                                <div class="feature-item">
                                    <span class="feature-icon">🎤</span>
                                    <span>Voice interaction support</span>
                                </div>
                            </div>
                            
                            <div class="getting-started">
                                <h3>Getting Started:</h3>
                                <ul>
                                    <li>Use the quick actions in the sidebar</li>
                                    <li>Type your question or request below</li>
                                    <li>Try voice commands with the microphone button</li>
                                    <li>Export your chat history anytime</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Chat Input -->
            <div class="chat-input-container">
                <div class="input-wrapper">
                    <textarea 
                        id="chatInput" 
                        placeholder="Ask me about Oracle EBS procedures, search data, or get recommendations..."
                        rows="1"
                        maxlength="2000"
                    ></textarea>
                    
                    <div class="input-controls">
                        <button id="voiceButton" class="input-btn" title="Voice Input">
                            🎤
                        </button>
                        
                        <button id="attachButton" class="input-btn" title="Attach File">
                            📎
                        </button>
                        
                        <button id="sendButton" class="input-btn" title="Send Message" disabled>
                            ➤
                        </button>
                    </div>
                </div>
                
                <div class="input-footer">
                    <div class="input-stats">
                        <span id="charCount">0/2000</span>
                    </div>
                    <div class="input-hints">
                        <span>💡 Try: "Start work confirmation" or "Show analytics dashboard"</span>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Screenshot Modal -->
    <div id="screenshotModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Screenshot</h3>
                <button class="modal-close" onclick="assistant.closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <img id="modalImage" src="" alt="Screenshot" />
            </div>
            <div class="modal-footer">
                <button class="modal-btn secondary" onclick="assistant.closeModal()">Close</button>
                <button class="modal-btn primary" onclick="assistant.downloadScreenshot()">Download</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <div class="loading-text">Processing your request...</div>
        </div>
    </div>

    <!-- File Upload Input (Hidden) -->
    <input type="file" id="fileInput" style="display: none;" accept=".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg" multiple>

    <!-- Scripts -->
    <script src="advanced-app.js"></script>
    
    <script>
        // Initialize welcome time
        document.getElementById('welcomeTime').textContent = new Date().toLocaleTimeString();
        
        // Character counter
        document.getElementById('chatInput').addEventListener('input', function() {
            const count = this.value.length;
            document.getElementById('charCount').textContent = `${count}/2000`;
        });
        
        // Session duration timer
        let sessionStart = Date.now();
        setInterval(() => {
            const duration = Date.now() - sessionStart;
            const minutes = Math.floor(duration / 60000);
            const seconds = Math.floor((duration % 60000) / 1000);
            document.getElementById('sessionDuration').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }, 1000);
        
        // Auto-resize textarea
        document.getElementById('chatInput').addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });
        
        // File upload handler
        document.getElementById('attachButton').addEventListener('click', () => {
            document.getElementById('fileInput').click();
        });
        
        document.getElementById('fileInput').addEventListener('change', (e) => {
            const files = Array.from(e.target.files);
            if (files.length > 0) {
                assistant.handleFileUpload(files);
            }
        });
        
        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + K to focus search
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                document.getElementById('chatInput').focus();
            }
            
            // Ctrl/Cmd + / to show help
            if ((e.ctrlKey || e.metaKey) && e.key === '/') {
                e.preventDefault();
                assistant.showHelp();
            }
        });
        
        // Service Worker for offline support
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').catch(console.error);
        }
    </script>
</body>
</html>